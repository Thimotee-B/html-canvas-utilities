import{r as q,i as Q,s as J,$ as Z,n as tt}from"./vendor.6869b30c.js";const et=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};et();function W(o){if(o.length===0)return new DOMRect(0,0,0,0);var n=new DOMRect(o[0].x,o[0].y,o[0].width,o[0].height);return o.reduce(function(t,e){return e.x<t.x&&(t.width+=t.x-e.x,t.x=e.x),e.y<t.y&&(t.height+=t.y-e.y,t.y=e.y),e.x+e.width>t.x+t.width&&(t.width=e.x+e.width-t.x),e.y+e.height>t.y+t.height&&(t.height=e.y+e.height-t.y),t},n)}function b(o,n){var t=o.ctx,e=o.size;t.save(),t.strokeStyle=o.resolveValue(n),t.strokeRect(0,0,e.width,e.height),t.restore()}var rt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),L=function(){function o(){this.listeners=[]}return o.prototype.addListener=function(n){this.listeners.push(n)},o.prototype.removeListener=function(n){this.listeners=this.listeners.filter(function(t){return t!==n})},o.prototype.notifyListeners=function(n){for(var t=0,e=this.listeners;t<e.length;t++){var r=e[t];r(n)}},o}();(function(o){rt(n,o);function n(t){var e=o.call(this)||this;return e.value=t,e}return n.prototype.update=function(t){this.value=t,this.notifyListeners()},n})(L);var nt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),M=globalThis&&globalThis.__assign||function(){return M=Object.assign||function(o){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o},M.apply(this,arguments)},B=function(o){nt(n,o);function n(){var t=o!==null&&o.apply(this,arguments)||this;return t.hidden=!1,t}return n.prototype.selectAt=function(t,e){var r=this.rect;return t.x>=r.x&&t.x<=r.x+r.width&&t.y>=r.y&&t.y<=r.y+r.height&&e===0?this:null},n.prototype.drawDecoration=function(t,e,r){var i=this.rect,s=M(M({},t),{size:i});e.length>0&&e.includes(this)?b(s,"--canvas-selected-color"):r.length>0&&r.includes(this)&&b(s,"--canvas-hovered-color")},n.prototype.move=function(t){this.rect.x+=t.x,this.rect.y+=t.y},n.prototype.resize=function(t){this.rect.width=t.width,this.rect.height=t.height},Object.defineProperty(n.prototype,"size",{get:function(){return{width:this.rect.width,height:this.rect.height}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offset",{get:function(){return{x:this.rect.x,y:this.rect.y}},enumerable:!1,configurable:!0}),n.prototype.onClick=function(t){var e={type:"click",offset:{x:t.x,y:t.y}};this.notifyListeners(e)},n.prototype.onHover=function(t){var e={type:"hover",offset:{x:t.x,y:t.y}};this.notifyListeners(e)},n.prototype.onUpdate=function(t){var e={type:"update",time:t};this.notifyListeners(e)},n}(L),I=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$=function(o){I(n,o);function n(t){var e=this,r;return e=o.call(this)||this,e._fillColor=t==null?void 0:t.fillColor,e._strokeColor=t==null?void 0:t.strokeColor,e._lineWidth=(r=t==null?void 0:t.lineWidth)!==null&&r!==void 0?r:1,e}return Object.defineProperty(n.prototype,"fillColor",{get:function(){return this._fillColor},set:function(t){this._fillColor=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(t){this._strokeColor=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n}(B),E=function(o){I(n,o);function n(t){var e=o.call(this,t)||this;return e._rect=t.rect,e}return Object.defineProperty(n.prototype,"rect",{get:function(){return this._rect},set:function(t){this._rect=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n}($),ot=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),F=function(o){ot(n,o);function n(t){var e=o.call(this,t)||this;return e.rect=t.rect,e}return n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save(),e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor));var i=r.width;e.beginPath(),e.moveTo(0,0),e.lineTo(i,0),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),e.restore()},n}(E),it=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),st=function(o){it(n,o);function n(t){var e=o.call(this,t)||this;return e.startArrow=t.startArrow||"none",e.endArrow=t.endArrow||"line-arrow",e}return Object.defineProperty(n.prototype,"startArrow",{get:function(){return this._startArrow},set:function(t){this._startArrow=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endArrow",{get:function(){return this._endArrow},set:function(t){this._endArrow=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save(),e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor));var i=r.width,s=new DOMPoint(0,0),a=new DOMPoint(i,0);e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(a.x,a.y),e.closePath(),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),this.startArrow&&V(e,s,this.startArrow),this.endArrow&&V(e,a,this.endArrow),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),e.restore()},n}(F);function V(o,n,t){var e=n.x,r=n.y,i=10,s=10;t==="line-arrow"&&(o.beginPath(),o.moveTo(e,r),o.lineTo(e-i,r-s),o.moveTo(e-i,r+s),o.lineTo(e,r)),t==="triangle-arrow"&&(o.beginPath(),o.moveTo(e,r),o.lineTo(e-i,r-s),o.lineTo(e-i,r+s),o.lineTo(e,r),o.closePath())}var at=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),lt=function(o){at(n,o);function n(t){var e=this,r;return e=o.call(this,t)||this,e.counterclockwise=(r=t.counterclockwise)!==null&&r!==void 0?r:!1,e}return Object.defineProperty(n.prototype,"counterclockwise",{get:function(){return this._counterclockwise},set:function(t){this._counterclockwise=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save();var i=r.width,s=r.height,a=i/2,l=s/2,c=0,h=2*Math.PI,u=0,f=!1;e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor)),e.translate(a,l),e.beginPath(),e.ellipse(0,0,a,l,u,c,h,f),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),e.restore()},n}(E),ct=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),y=function(o){ct(n,o);function n(t){var e=o.call(this,t)||this;return e.cornerRadius=t.cornerRadius,e}return Object.defineProperty(n.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx,r=t.size;if(e.save(),e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor)),this.cornerRadius)if(Array.isArray(this.cornerRadius)){var i=this.cornerRadius,s=i[0],a=i[1],l=i[2],c=i[3];T(e,r,{tl:s,tr:a,br:l,bl:c}),this.fillColor&&e.fill(),this.strokeColor&&e.stroke()}else{var h=this.cornerRadius;T(e,r,{tl:h,tr:h,br:h,bl:h}),this.fillColor&&e.fill(),this.strokeColor&&e.stroke()}else this.fillColor&&e.fillRect(0,0,r.width,r.height),this.strokeColor&&e.strokeRect(0,0,r.width,r.height);e.restore()},n}(E);function T(o,n,t){var e=t.tl,r=t.tr,i=t.br,s=t.bl;o.beginPath(),o.moveTo(e,0),o.lineTo(n.width-r,0),o.quadraticCurveTo(n.width,0,n.width,r),o.lineTo(n.width,n.height-i),o.quadraticCurveTo(n.width,n.height,n.width-i,n.height),o.lineTo(s,n.height),o.quadraticCurveTo(0,n.height,0,n.height-s),o.lineTo(0,e),o.quadraticCurveTo(0,0,e,0),o.closePath()}var ht=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ut=function(o){ht(n,o);function n(t){var e=o.call(this,t)||this;e.loaded=!1,e.error=!1;var r=new Image;return r.crossOrigin="anonymous",r.src=t.image,e.image=r,r.onload=function(){e.loaded=!0},r.onerror=function(){e.error=!0,e.loaded=!0},e.smoothingEnabled=t.smoothingEnabled,e.smoothingQuality=t.smoothingQuality,e.filter=t.filter,e}return n.prototype.draw=function(t){var e=t.ctx,r=t.size;if(o.prototype.draw.call(this,t),this.error)Y(t,"red");else if(this.loaded){if(e.save(),this.smoothingEnabled&&this.smoothingQuality&&(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality=this.smoothingQuality),this.cornerRadius){if(Array.isArray(this.cornerRadius)){var i=this.cornerRadius,s=i[0],a=i[1],l=i[2],c=i[3];T(e,r,{tl:s,tr:a,br:l,bl:c})}else{var h=this.cornerRadius;T(e,r,{tl:h,tr:h,br:h,bl:h})}e.clip()}this.filter&&(e.filter=this.filter),e.drawImage(this.image,0,0,r.width,r.height),e.restore()}else Y(t,"--canvas-grid-color")},n}(y);function Y(o,n){var t=o.ctx,e=o.size;t.save(),t.fillStyle=o.resolveValue(n),t.strokeStyle=o.resolveValue(n),t.strokeRect(0,0,e.width,e.height),t.beginPath(),t.moveTo(0,0),t.lineTo(e.width,e.height),t.moveTo(e.width,0),t.lineTo(0,e.height),t.stroke(),t.restore()}var ft=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),G=function(o){ft(n,o);function n(t){var e=o.call(this,t)||this;return e.pointCount=t.pointCount||5,e}return Object.defineProperty(n.prototype,"pointCount",{get:function(){return this._pointCount},set:function(t){this._pointCount=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save(),e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor));var i=r.width,s=r.height,a=i/2,l=s/2;e.beginPath();for(var c=0;c<this.pointCount;c++){var h=Math.PI*2/this.pointCount,u=a+a*Math.cos(h*c),f=l+l*Math.sin(h*c);c===0?e.moveTo(u,f):e.lineTo(u,f)}e.closePath(),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),e.restore()},n}(E),dt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),vt=function(o){dt(n,o);function n(t){var e=o.call(this,t)||this;return e.innerRadius=t.innerRadius,e.outerRadius=t.outerRadius,e}return Object.defineProperty(n.prototype,"innerRadius",{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"outerRadius",{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save(),e.lineWidth=this.lineWidth,this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor));var i=r.width,s=r.height,a=i/2,l=s/2,c=this.innerRadius||a/2,h=this.outerRadius||i/2,u=Math.PI/2*3,f=a,d=l,v=Math.PI/this.pointCount;e.beginPath(),e.moveTo(a,l-h);for(var g=0;g<this.pointCount;g++)f=a+Math.cos(u)*h,d=l+Math.sin(u)*h,e.lineTo(f,d),u+=v,f=a+Math.cos(u)*c,d=l+Math.sin(u)*c,e.lineTo(f,d),u+=v;e.lineTo(a,l-h),e.closePath(),this.fillColor&&e.fill(),this.strokeColor&&e.stroke(),e.restore()},n}(G),pt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),N=function(o){pt(n,o);function n(t){var e=this,r,i,s,a,l;return e=o.call(this)||this,e._x=0,e._y=0,e.removeOnEmpty=!0,e.characters=t.characters,e.fillColor=t.fillColor,e.strokeColor=t.strokeColor,e.x=t.offset.x,e.y=t.offset.y,e.fontSize=(r=t.fontSize)!==null&&r!==void 0?r:16,e.fontFamily=(i=t.fontFamily)!==null&&i!==void 0?i:"sans-serif",e.direction=(s=t.direction)!==null&&s!==void 0?s:"inherit",e.textAlign=(a=t.textAlign)!==null&&a!==void 0?a:"start",e.textBaseline=(l=t.textBaseline)!==null&&l!==void 0?l:"middle",e}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"characters",{get:function(){return this._characters},set:function(t){this._characters=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this._fontFamily=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textAlign",{get:function(){return this._textAlign},set:function(t){this._textAlign=t,this.notifyListeners()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n.prototype.draw=function(t){var e=t.ctx;t.size,e.save();var r=this.text(e);r.width;var i=r.height;e.translate(0,i/2),this.fillColor&&(e.fillStyle=t.resolveValue(this.fillColor),e.fillText(this.characters,0,0)),this.strokeColor&&(e.strokeStyle=t.resolveValue(this.strokeColor),e.strokeText(this.characters,0,0)),e.translate(0,-(i/2)),e.restore()},n.prototype.text=function(t){t.lineWidth=this.lineWidth,t.font="".concat(this.fontSize,"px ").concat(this.fontFamily),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.direction=this.direction;var e=t.measureText(this.characters).width,r=this.fontSize;return{width:e,height:r}},n.prototype.move=function(t){this.x+=t.x,this.y+=t.y},Object.defineProperty(n.prototype,"rect",{get:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),r=this.text(e),i=r.width,s=r.height;return new DOMRect(this.x,this.y,i,s)},enumerable:!1,configurable:!0}),n}($),yt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),w=globalThis&&globalThis.__assign||function(){return w=Object.assign||function(o){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o},w.apply(this,arguments)},K=function(o){yt(n,o);function n(t){var e=o.call(this,t)||this;return e.padding=t.padding,e.child=t.child,e}return n.prototype.draw=function(t){var e=t.ctx,r=t.size,i=w({},r),s=w(w({},t),{size:i});o.prototype.draw.call(this,s),A(this.padding,function(a,l,c,h){e.translate(l,a),i.width-=l+h,i.height-=a+c}),this.child.draw(s)},n.prototype.drawDecoration=function(t,e,r){var i=t.ctx;A(this.padding,function(l,c){i.translate(-c,-l)});var s=w(w({},t),{size:this.rect});e.length>0&&e.includes(this)?b(s,"--canvas-selected-color"):r.length>0&&r.includes(this)&&b(s,"--canvas-hovered-color");var a={width:this.rect.width,height:this.rect.height};A(this.padding,function(l,c,h,u){i.translate(c,l),a.width-=c+u,a.height-=l+h}),this.child.drawDecoration(w(w({},s),{size:a}),e,r)},n.prototype.selectAt=function(t,e){var r=o.prototype.selectAt.call(this,t,e);if(r)return r;var i=new DOMPoint(t.x-this.rect.x,t.y-this.rect.y),s=this.child.selectAt(i,e-1);return s||null},n}(y);function A(o,n){if(o)if(Array.isArray(o)){var t=o[0],e=o[1],r=o[2],i=o[3];n(t,e,r,i)}else{var s=o;n(s,s,s,s)}}var gt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),wt=function(o){gt(n,o);function n(t){var e=o.call(this,t)||this;return e.label=t.label,e}return n.prototype.draw=function(t){this.drawLabel(t),o.prototype.draw.call(this,t)},n.prototype.drawLabel=function(t){var e=t.ctx,r=t.scale;e.scale(1/r,1/r);var i=1.2,s=10*i;e.font="".concat(s,"px sans-serif"),e.fillStyle=t.resolveValue("--canvas-text-color");var a="...",l=e.measureText(this.label).width,c=s,h=this.rect.width*r;if(e.translate(0,-6),l>h){var u=e.measureText(a).width;l=h-u;var f=this.label;f=f.slice(0,-3),f+=a,e.save(),e.beginPath(),e.rect(0,-c,h,20),e.clip(),e.fillText(f,0,0),e.restore()}else e.fillText(this.label,0,0);e.translate(0,6),e.scale(r,r)},n}(K),_t=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),xt=function(o){_t(n,o);function n(t){var e=o.call(this)||this;return e.children=t.children,e}return Object.defineProperty(n.prototype,"children",{get:function(){return this._children},set:function(t){this._children=t,this.notifyListeners()},enumerable:!1,configurable:!0}),n}(B),mt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),C=globalThis&&globalThis.__assign||function(){return C=Object.assign||function(o){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o},C.apply(this,arguments)},Ot=function(o){mt(n,o);function n(t){var e=this,r;return e=o.call(this,t)||this,e.rect=t.rect,e.clip=(r=t.clip)!==null&&r!==void 0?r:!0,e}return n.prototype.draw=function(t){var e=t.ctx,r=t.size;e.save(),this.clip&&(e.save(),e.beginPath(),e.rect(0,0,r.width,r.height),e.clip());for(var i=0,s=this.children;i<s.length;i++){var a=s[i];e.translate(a.rect.x,a.rect.y),a.draw(C(C({},t),{size:a.rect})),e.translate(-a.rect.x,-a.rect.y)}e.restore()},n.prototype.selectAt=function(t,e){var r=o.prototype.selectAt.call(this,t,e);if(r)return r;for(var i=0,s=Array.from(this.children).reverse();i<s.length;i++){var a=s[i],l=new DOMPoint(t.x-this.rect.x,t.y-this.rect.y),c=a.selectAt(l,e-1);if(c)return c}return null},n.prototype.drawDecoration=function(t,e,r){var i=t.ctx,s=C(C({},t),{size:this.rect});o.prototype.drawDecoration.call(this,s,e,r);for(var a=0,l=this.children;a<l.length;a++){var c=l[a];i.translate(c.rect.x,c.rect.y),c.drawDecoration(s,e,r),i.translate(-c.rect.x,-c.rect.y)}},n}(xt);function Ct(o,n){var t=o.ctx;o.size;var e=o.scale,r=o.offset,i=n.backgroundColor,s=n.gridColor,a=t.canvas;t.save();var l=20*e,c=Math.round(r.x)%l,h=Math.round(r.y)%l;t.fillStyle=o.resolveValue(i),t.fillRect(0,0,a.width,a.height),t.strokeStyle=o.resolveValue(s),t.lineWidth=.23*e;for(var u=c;u<a.width;u+=l)t.beginPath(),t.moveTo(u,0),t.lineTo(u,a.height),t.stroke();for(var f=h;f<a.height;f+=l)t.beginPath(),t.moveTo(0,f),t.lineTo(a.width,f),t.stroke();t.restore()}var Pt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),U={scale:1,offset:new DOMPoint(0,0)},St=function(o){Pt(n,o);function n(t,e){t===void 0&&(t=document.createElement("canvas")),e===void 0&&(e=U);var r=o.call(this)||this;r.canvas=t,r.options=e,r.gestureEvent=!1,r.mouse=new DOMPoint(0,0),r.mouseDown=!1,r.spacePressed=!1,r.controlPressed=!1,r.shiftPressed=!1,r.metaPressed=!1,r.middleClick=!1,r.shouldNotify=!0,r.minScale=.1,r.maxScale=10,r.ctx=r.canvas.getContext("2d"),r.transform=r.ctx.getTransform(),r.shouldNotify=!1;var i=e.scale,s=e.offset;return r.scale(i),r.pan(s),r.shouldNotify=!0,t.addEventListener("wheel",r.onWheelEvent.bind(r),{passive:!1}),t.addEventListener("mousedown",r.onMouseDown.bind(r),!1),t.addEventListener("mousemove",r.onMouseMove.bind(r),!1),t.addEventListener("mouseup",r.onMouseUp.bind(r),!1),t.addEventListener("touchstart",r.onTouchStart.bind(r),!1),t.addEventListener("touchmove",r.onTouchMove.bind(r),!1),t.addEventListener("touchend",r.onTouchEnd.bind(r),!1),t.addEventListener("dblclick",r.onDoubleClick.bind(r),!1),t.addEventListener("click",r.onClick.bind(r),!1),t.addEventListener("gesturestart",r.onGestureStart.bind(r),!1),t.addEventListener("gesturechange",r.onGestureChange.bind(r),!1),t.addEventListener("gestureend",r.onGestureEnd.bind(r),!1),document.addEventListener("keydown",r.onKeyDownEvent.bind(r),!1),document.addEventListener("keyup",r.onKeyUpEvent.bind(r),!1),t.addEventListener("dragover",r.onDrop.bind(r),!1),t.addEventListener("drop",r.onDrop.bind(r),!1),r}return Object.defineProperty(n.prototype,"matrix",{get:function(){return this.transform},set:function(t){this.transform=t,this.notify()},enumerable:!1,configurable:!0}),n.prototype.notify=function(){!this.shouldNotify||this.notifyListeners()},n.prototype.localPoint=function(t){var e=this.info,r=e.scale,i=e.offset,s=t.x/r-i.x/r,a=t.y/r-i.y/r;return new DOMPoint(s,a)},n.prototype.worldPoint=function(t){var e=this.info,r=e.scale,i=e.offset,s=t.x*r+i.x,a=t.y*r+i.y;return new DOMPoint(s,a)},n.prototype.applyTransform=function(t){t.setTransform(this.matrix)},n.prototype.scale=function(t,e){if(!Number.isNaN(t)){var r=t*this.info.scale;if(this.options.scale=r,!(r<this.minScale||r>this.maxScale)){var i=e||this.mouse,s=this.localPoint(i);this.matrix=this.matrix.scale(t,t,0,s.x,s.y,s.z),this.notify()}}},n.prototype.zoom=function(t,e){if(!Number.isNaN(t)){var r=this.info.scale-t;if(this.options.scale=t,!(t<this.minScale||t>this.maxScale)){var i=e||this.mouse,s=this.localPoint(i);this.matrix=this.matrix.scale(r,r,0,s.x,s.y,s.z),this.notify()}}},n.prototype.zoomIn=function(){this.scale(1.1)},n.prototype.zoomOut=function(){this.scale(.9)},n.prototype.reset=function(){this.matrix=new DOMMatrix},n.prototype.pan=function(t){if(!Number.isNaN(t)){var e=this.info.scale;this.options.offset.x+=t.x/e,this.options.offset.y+=t.y/e,this.matrix=this.matrix.translate(t.x/e,t.y/e,t.z/e),this.notify()}},Object.defineProperty(n.prototype,"info",{get:function(){var t=bt(this.matrix),e=t.scaleX,r=t.scaleY,i=t.translateX,s=t.translateY,a=t.rotate;return{scale:Math.min(e,r),offset:new DOMPoint(i,s),rotation:a,mouse:this.mouse,mouseDown:this.mouseDown}},enumerable:!1,configurable:!0}),n.prototype.onWheelEvent=function(t){if(this.preventDefault(t),!this.gestureEvent){var e=new DOMPoint(t.offsetX,t.offsetY);if(t.ctrlKey||this.controlPressed){var r=1;t.deltaY<0?r=Math.min(this.maxScale,r*1.1):r=Math.max(this.minScale,r*(1/1.1)),this.scale(r,e)}else this.pan(new DOMPoint(-t.deltaX,-t.deltaY))}},n.prototype.onMouseDown=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY),this.mouseDown=!0},n.prototype.onMouseMove=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY)},n.prototype.onMouseUp=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY),this.mouseDown=!1},n.prototype.onTouchStart=function(t){this.preventDefault(t),this.touches=t.touches,this.mouseDown=!0,this.gestureEvent=this.touches.length>1},n.prototype.onTouchMove=function(t){this.preventDefault(t);var e=this.touches;if(this.touches=t.touches,this.gestureEvent){var r=new DOMPoint(e[0].clientX,e[0].clientY),i=new DOMPoint(e[1].clientX,e[1].clientY),s=new DOMPoint(this.touches[0].clientX,this.touches[0].clientY),a=new DOMPoint(this.touches[1].clientX,this.touches[1].clientY);if(this.touches.length===2){var l=new DOMPoint((r.x+i.x)/2,(r.y+i.y)/2),c=new DOMPoint((s.x+a.x)/2,(s.y+a.y)/2),h=X(r,i),u=X(s,a),f=u/h;if(this.scale(f,c),c!==l){var d=new DOMPoint(Math.min(r.x,i.x),Math.min(r.y,i.y)),v=new DOMPoint(Math.min(s.x,a.x),Math.min(s.y,a.y)),g=new DOMPoint(v.x-d.x,v.y-d.y);this.pan(g)}}else if(this.touches.length===3){var _=new DOMPoint(e[2].clientX,e[2].clientY),p=new DOMPoint(this.touches[2].clientX,this.touches[2].clientY),d=new DOMPoint(Math.min(r.x,i.x,_.x),Math.min(r.y,i.y,_.y)),v=new DOMPoint(Math.min(s.x,a.x,_.x),Math.min(s.y,a.y,p.y)),g=new DOMPoint(v.x-d.x,v.y-d.y);this.pan(g)}}},n.prototype.onTouchEnd=function(t){this.preventDefault(t),this.touches=t.touches,this.mouseDown=this.touches.length===0,this.gestureEvent=this.touches.length>1},n.prototype.onKeyDownEvent=function(t){var e=this.canvas===document.activeElement;!e||(this.preventDefault(t),t.key==="ArrowLeft"?this.pan(new DOMPoint(-10,0)):t.key==="ArrowRight"?this.pan(new DOMPoint(10,0)):t.key==="ArrowUp"?this.pan(new DOMPoint(0,-10)):t.key==="ArrowDown"?this.pan(new DOMPoint(0,10)):t.key==="="?this.scale(1.1,this.mouse):t.key==="-"&&this.scale(1/1.1,this.mouse),this.controlPressed=t.ctrlKey,this.shiftPressed=t.shiftKey,this.metaPressed=t.metaKey,this.spacePressed=t.key===" ")},n.prototype.onKeyUpEvent=function(t){this.preventDefault(t),this.controlPressed=!1,this.spacePressed=!1,this.shiftPressed=!1,this.metaPressed=!1},n.prototype.onDoubleClick=function(t){this.preventDefault(t)},n.prototype.onClick=function(t){this.preventDefault(t)},n.prototype.onDragOver=function(t){this.preventDefault(t)},n.prototype.onDrop=function(t){this.preventDefault(t)},n.prototype.onGestureStart=function(t){return this.preventDefault(t),this._previousGesture=t,this.gestureEvent=!0,!1},n.prototype.onGestureChange=function(t){this.preventDefault(t);var e=new DOMPoint(t.clientX,t.clientY),r=this._previousGesture.scale,i=t.scale,s=i/r;return this.scale(s,e),this._previousGesture=t,!1},n.prototype.onGestureEnd=function(t){return this.preventDefault(t),this._previousGesture=t,this.gestureEvent=!1,!1},n.prototype.preventDefault=function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()},n}(L);function bt(o){var n=(o.a+o.d)/2,t=(o.a-o.d)/2,e=(o.c+o.b)/2,r=(o.c-o.b)/2,i=Math.sqrt(n*n+r*r),s=Math.sqrt(t*t+e*e),a=Math.atan2(e,t),l=Math.atan2(r,n),c=(l-a)/2,h=(l+a)/2;return{translateX:o.e,translateY:o.f,rotate:-h*180/Math.PI,scaleX:i+s,scaleY:i-s,skew:-c*180/Math.PI}}function X(o,n){return Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2))}var Mt=globalThis&&globalThis.__extends||function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},o(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),x=globalThis&&globalThis.__assign||function(){return x=Object.assign||function(o){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o},x.apply(this,arguments)},Tt=x(x({},U),{devicePixelRatio:window.devicePixelRatio||1,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}),Dt=function(o){Mt(n,o);function n(t,e){t===void 0&&(t=document.createElement("canvas")),e===void 0&&(e=Tt);var r=o.call(this,t,e)||this;return r.canvas=t,r.options=e,r.children=[],r.selection=[],r.hovered=[],r.canSelect=!0,r.canMove=!0,r.canDelete=!0,r.canEditText=!0,r.drawGrid=!0,r.selectIndex=0,r.isMoving=!1,r.editingText=!1,r}return n.prototype.drawBackground=function(){var t=this.info,e=t.offset,r=t.scale,i=this,s=i.ctx,a=i.canvas;if(this.options.drawBackground!==void 0){s.save(),this.options.drawBackground(s,e,r),s.restore();return}s.save(),s.fillStyle=this.resolveValue(a,"--canvas-background-color"),s.fillRect(0,0,a.width,a.height),this.drawGrid&&Ct(this.getContext(s),{backgroundColor:"--canvas-background-color",gridColor:"--canvas-grid-color"}),s.restore()},n.prototype.resize=function(){var t=this.canvas,e=getComputedStyle(t),r=this,i=r.canvas;r.ctx;var s=parseInt(e.width,10),a=parseInt(e.height,10);i.width=s,i.height=a},n.prototype.canvasResize=function(){var t=this,e=t.canvas,r=t.ctx,i=e.getBoundingClientRect(),s=this.options.devicePixelRatio;e.width=i.width*s,e.height=i.height*s,r.clearRect(0,0,e.width,e.height),r.scale(s,s)},n.prototype.paint=function(t){var e=this;t===void 0&&(t=0);var r=this,i=r.canvas,s=r.ctx;if(this.resize(),s.imageSmoothingEnabled=this.options.imageSmoothingEnabled,s.imageSmoothingQuality=this.options.imageSmoothingQuality,s.clearRect(0,0,i.width,i.height),this.drawBackground(),this.applyTransform(s),this.drawContent(s,t),this.applyTransform(s),this.selection.length>1){var a=W(this.selection.map(function(l){return l.rect}));s.save(),s.translate(a.x,a.y),this.drawOutline(this.getContext(s),"--canvas-selected-color"),s.restore()}requestAnimationFrame(function(l){return e.paint(l)})},n.prototype.drawContent=function(t,e){for(var r=0,i=this.children;r<i.length;r++){var s=i[r];this.drawChild(t,s,e)}},n.prototype.drawChild=function(t,e,r){var i=e.offset;t.save(),t.translate(i.x,i.y);var s=this.getContext(t);e.onUpdate(r),e.hidden||e.draw(x(x({},s),{size:e.size})),e.drawDecoration(s,this.selection,this.hovered),t.translate(-i.x,-i.y),t.restore()},n.prototype.getContext=function(t){var e=this;return x({ctx:t,size:{width:this.canvas.width,height:this.canvas.height},resolveValue:function(r){return e.resolveValue(t.canvas,r)}},this.info)},n.prototype.drawOutline=function(t,e){var r=t.ctx,i=t.size,s=this.canvas;if(this.options.drawOutline!==void 0){r.save(),this.options.drawOutline(r,i,e),r.restore();return}r.save(),r.strokeStyle=this.resolveValue(s,e),r.strokeRect(0,0,i.width,i.height),r.restore()},n.prototype.getSelectionAt=function(t,e){for(var r=this.localPoint(t),i=[],s=this.selectIndex+1;i.length===0&&s>-1;){s--;for(var a=0,l=Array.from(this.children).reverse();a<l.length;a++){var c=l[a],h=c.selectAt(r,s);h&&i.push(h)}}return i.slice(0,e.max)},n.prototype.onMouseDown=function(t){if(o.prototype.onMouseDown.call(this,t),this.middleClick=t.button===1,this.canSelect){if(this.selection.length>0){var e=this.localPoint(this.mouse),r=W(this.selection.map(function(s){return s.rect}));if(e.x>=r.x&&e.x<=r.x+r.width&&e.y>=r.y&&e.y<=r.y+r.height)return}var i=this.getSelectionAt(this.mouse,{max:1,level:this.selectIndex});this.updateSelection(i)}this.updateCursor()},n.prototype.onMouseUp=function(t){o.prototype.onMouseUp.call(this,t),this.isMoving=!1,this.middleClick=!1,this.updateCursor()},n.prototype.resolveValue=function(t,e){if(e.startsWith("--"))for(var r=getComputedStyle(t!=null?t:document.body),i=e.split(","),s=0,a=i;s<a.length;s++){var l=a[s];if(l!==""&&!l.startsWith("--"))return l;var c=r.getPropertyValue(l);if(c!=="")return c}return e},n.prototype.onMouseMove=function(t){var e=this.mouse;o.prototype.onMouseMove.call(this,t),this.hovered=this.getSelectionAt(this.mouse,{max:1,level:0});for(var r=0,i=this.hovered;r<i.length;r++){var s=i[r];s.onHover(this.mouse)}this.mouseDown&&(this.isMoving=!0,this.move(new DOMPoint(this.mouse.x-e.x,this.mouse.y-e.y))),this.updateCursor()},n.prototype.onTouchStart=function(t){o.prototype.onTouchStart.call(this,t)},n.prototype.onTouchMove=function(t){var e=(this.touches||[])[0];if(o.prototype.onTouchMove.call(this,t),!this.gestureEvent){var r=t.touches[0],i=new DOMPoint(r.clientX-e.clientX,r.clientY-e.clientY);this.move(i)}},n.prototype.move=function(t){if(this.spacePressed||this.middleClick)this.pan(new DOMPoint(t.x,t.y));else if(this.canMove&&this.selection.length>0){for(var e=this.info.scale,r=0,i=this.selection;r<i.length;r++){var s=i[r];s.move({x:t.x/e,y:t.y/e})}this.notify()}},n.prototype.onKeyDownEvent=function(t){var e=this.canvas===document.activeElement;!e||(o.prototype.onKeyDownEvent.call(this,t),t.key==="Backspace"&&this.removeSelection(),t.metaKey&&t.key==="a"&&this.updateSelection(this.children),this.updateCursor())},n.prototype.onKeyUpEvent=function(t){o.prototype.onKeyUpEvent.call(this,t),this.updateCursor()},n.prototype.updateCursor=function(){var t=this,e=t.hovered,r=t.selection,i=t.spacePressed,s=t.canMove,a=r.length>0&&r.every(function(l){return e.includes(l)});i||this.middleClick?this.canvas.style.cursor="grab":r.length>0&&a&&s?this.canvas.style.cursor="move":this.canvas.style.cursor="default"},n.prototype.selectAt=function(t){for(var e=this.getSelectionAt(t,{max:1,level:this.selectIndex}),r=0,i=e;r<i.length;r++){var s=i[r];if(s instanceof N&&this.selectIndex>0&&this.canEditText){this.onEditText(t,s);continue}s.onClick(t)}this.updateSelection(e)},n.prototype.onEditText=function(t,e){var r=this,i;this.editingText=!0,e.hidden=!0;var s=e.characters,a=document.createElement("input"),l=this.worldPoint(new DOMPoint(e.rect.x,e.rect.y)),c=a.style;c.position="fixed",c.left="".concat(l.x,"px"),c.top="".concat(l.y,"px");var h=this.info.scale,u=e.fontSize*h,f=e.rect.width*h,d=e.rect.height*h;c.width="".concat(f,"px"),c.height="".concat(d,"px"),c.fontSize="".concat(u,"px"),c.fontFamily=e.fontFamily,c.zIndex="1",c.border="none",c.outline="none",c.padding="0",c.margin="0",c.textAlign=e.textAlign,c.direction=e.direction,c.verticalAlign=e.textBaseline,c.backgroundColor="var(--canvas-background-color)";var v=(i=e.fillColor)!==null&&i!==void 0?i:e.strokeColor;c.color=this.resolveValue(this.canvas,v),document.body.appendChild(a),a.focus(),a.value=e.characters,a.addEventListener("input",function(p){var m=p.target;e.characters=m.value;var S=document.createElement("canvas"),j=S.getContext("2d");j.font="".concat(u,"px ").concat(e.fontFamily);var z=j.measureText(m.value).width;e.rect.width=z*h,c.width="".concat(z,"px")});var g=!1,_=function(p){if(p.preventDefault(),!g){var m=p.target,S=m.value.trim().length===0;r.canDelete?S&&e.removeOnEmpty?(r.selection=[e],r.removeSelection()):e.characters=m.value:e.characters=S?s:m.value,e.notifyListeners();try{a.remove()}catch{}return r.editingText=!1,g=!0,e.hidden=!1,!1}};a.addEventListener("blur",_.bind(this),!1),a.addEventListener("change",_.bind(this),!1),a.addEventListener("keydown",function(p){(p.key==="Enter"||p.key==="Escape")&&_(p)})},n.prototype.updateSelection=function(t){var e=this;this.shiftPressed?(this.selection=this.selection.concat(t),this.selection=this.selection.filter(function(r,i){return e.selection.indexOf(r)===i})):this.selection=t,this.updateCursor(),this.notify()},n.prototype.clearSelection=function(){this.updateSelection([])},n.prototype.removeSelection=function(){var t=this;!this.canDelete||(this.children=this.children.filter(function(e){return!t.selection.includes(e)}),this.clearSelection())},n.prototype.addChild=function(t){this.children.push(t),this.updateSelection([t])},n.prototype.onClick=function(t){if(o.prototype.onClick.call(this,t),this.canSelect&&!this.isMoving){var e=new DOMPoint(t.clientX,t.clientY);this.selectIndex=0,this.selectAt(e)}},n.prototype.onDoubleClick=function(t){if(o.prototype.onDoubleClick.call(this,t),this.canSelect&&!this.isMoving){var e=new DOMPoint(t.clientX,t.clientY);this.selectIndex+=1,this.selectAt(e)}},n.prototype.init=function(){var t=this;window.addEventListener("resize",function(){return t.resize()}),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.clearSelection(),this.canvasResize(),this.paint()},n}(St);function kt(o){const n=["circle","rect","star","polygon","line","arrow"];for(let r=0;r<20;r++){const i=n[Math.floor(Math.random()*n.length)],{x:s,y:a}={x:Math.random()*o.canvas.width,y:Math.random()*o.canvas.height},l=`hsl(${Math.random()*360}, 100%, 50%)`;i==="rect"&&o.addChild(new y({rect:new DOMRect(s,a,100,100),fillColor:l,cornerRadius:5})),i==="circle"&&o.addChild(new lt({rect:new DOMRect(s,a,100,100),fillColor:l})),i==="star"&&o.addChild(new vt({rect:new DOMRect(s,a,100,100),fillColor:l})),i==="polygon"&&o.addChild(new G({rect:new DOMRect(s,a,100,100),fillColor:l,pointCount:9})),i==="line"&&o.addChild(new F({rect:new DOMRect(s,a,100,1),strokeColor:l})),i==="arrow"&&o.addChild(new st({rect:new DOMRect(s,a,100,1),strokeColor:l,fillColor:l,endArrow:"triangle-arrow"}))}for(let r=0;r<5;r++){const{x:i,y:s}={x:Math.random()*o.canvas.width,y:Math.random()*o.canvas.height};o.addChild(new ut({rect:new DOMRect(i,s,100,100),image:`https://picsum.photos/seed/seed-${r+1}/300/300`}))}const{x:t,y:e}={x:Math.random()*o.canvas.width,y:Math.random()*o.canvas.height};o.addChild(new Ot({clip:!1,rect:new DOMRect(t,e,100,100),children:[new y({rect:new DOMRect(0,0,100,100),fillColor:"purple",cornerRadius:5}),new y({rect:new DOMRect(5,5,100,100),fillColor:"blue",cornerRadius:5}),new y({rect:new DOMRect(10,10,100,100),fillColor:"yellow",cornerRadius:5})]})),o.addChild(new K({rect:new DOMRect(1e3,1e3,100,100),fillColor:"gray",padding:10,child:new y({rect:new DOMRect(0,0,100,100),fillColor:"purple",cornerRadius:5})})),o.addChild(new wt({label:"Frame",rect:new DOMRect(600,600,100,100),fillColor:"gray",padding:10,child:new y({rect:new DOMRect(0,0,100,100),fillColor:"purple",cornerRadius:5})}))}const R=2,D={width:50,height:50},O={x:250,y:250};function Et(o){const n=(D.width+R)*3+D.width/2;P(o,O.x,[[1,0,1],[1,0,1],[1,1,1],[1,0,1],[1,0,1]]),P(o,O.x+n,[[1,1,1],[1,0,0],[1,1,1],[1,0,0],[1,1,1]]),P(o,O.x+n*2,[[1,0,0],[1,0,0],[1,0,0],[1,0,0],[1,1,1]]),P(o,O.x+n*3,[[1,0,0],[1,0,0],[1,0,0],[1,0,0],[1,1,1]]),P(o,O.x+n*4,[[1,1,1],[1,0,1],[1,0,1],[1,0,1],[1,1,1]])}function P(o,n,t){for(let e=0;e<t.length;e++)for(let r=0;r<t[e].length;r++)if(t[e][r]===1){const i=new y({rect:new DOMRect(n,O.y,D.width,D.height),fillColor:"#000000",cornerRadius:5});i.rect.x+=r*(i.rect.width+R),i.rect.y+=e*(i.rect.height+R),o.addChild(i);const s=i.rect.x,a=i.rect.y;i.onUpdate=l=>{i.rect.x=s+Math.sin(l/1e3)*10,i.rect.y=a+Math.cos(l/1e3)*10}}}function jt(o){const n=new y({rect:new DOMRect(100,500,150,150),fillColor:"hsl(0, 100%, 50%)"});n.onUpdate=t=>{const e=t/3e3,{h:r}=At(n.fillColor),i=(Math.sin(e)+1)/2,s=(r+360*i)%360;n.fillColor=`hsl(${s}, 100%, 50%)`},o.addChild(n)}function At(o){const n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o);return n?{h:parseInt(n[1]),s:parseFloat(n[2]),l:parseFloat(n[3])}:{h:0,s:0,l:0}}function Rt(o){const n=new N({offset:{x:0,y:0},characters:"Hello",fontFamily:"Arial",fillColor:"--canvas-text-color, red"});o.addChild(n)}var Lt=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,H=(o,n,t,e)=>{for(var r=e>1?void 0:e?zt(n,t):n,i=o.length-1,s;i>=0;i--)(s=o[i])&&(r=(e?s(n,t,r):s(r))||r);return e&&r&&Lt(n,t,r),r};let k=class extends J{render(){return Z` <canvas id="canvas"></canvas> `}firstUpdated(){const o=this.canvas,n=new Dt(o);n.addListener(()=>{const{offset:t,scale:e}=n.info;console.debug(`offset: ${t.x}, ${t.y}; scale: ${e}`)}),n.init(),Et(n),jt(n),kt(n),Rt(n)}};k.styles=q`
    * {
      --canvas-background-color: #fafafa;
      --canvas-grid-color: #ccc;
      --canvas-selected-color: #f00;
      --canvas-hovered-color: #0f0;
      --canvas-text-color: #000;
      cursor: pointer;
      user-select: none;
      user-zoom: none;
    }
    @media (prefers-color-scheme: dark) {
      * {
        --canvas-background-color: #333;
        --canvas-grid-color: #666;
        --canvas-selected-color: #bd0303;
        --canvas-hovered-color: #04a104;
        --canvas-text-color: #fff;
      }
    }
  `;H([Q("#canvas")],k.prototype,"canvas",2);k=H([tt("canvas-editor")],k);
