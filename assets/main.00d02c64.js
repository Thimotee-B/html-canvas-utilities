import{r as L,i as Y,s as X,$ as W,n as I}from"./vendor.6869b30c.js";const K=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}};K();function u(r,n){if(n.startsWith("--")){var t=getComputedStyle(r);return t.getPropertyValue(n)}return n}function M(r){if(r.length===0)return new DOMRect(0,0,0,0);var n=new DOMRect(r[0].x,r[0].y,r[0].width,r[0].height);return r.reduce(function(t,e){return e.x<t.x&&(t.width+=t.x-e.x,t.x=e.x),e.y<t.y&&(t.height+=t.y-e.y,t.y=e.y),e.x+e.width>t.x+t.width&&(t.width=e.x+e.width-t.x),e.y+e.height>t.y+t.height&&(t.height=e.y+e.height-t.y),t},n)}function S(r,n,t){r.save(),r.strokeStyle=u(r.canvas,t),r.strokeRect(0,0,n.width,n.height),r.restore()}var D=function(){function r(){}return r.prototype.selectAt=function(n,t){var e=this.rect;return n.x>=e.x&&n.x<=e.x+e.width&&n.y>=e.y&&n.y<=e.y+e.height&&t===0?this:null},r.prototype.drawDecoration=function(n,t,e){t.length>0&&t.includes(this)?S(n,this.rect,"--canvas-selected-color"):e.length>0&&e.includes(this)&&S(n,this.rect,"--canvas-hovered-color")},r}(),$=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),_=function(r){$(n,r);function n(){var t=r!==null&&r.apply(this,arguments)||this;return t.lineWidth=1,t}return n}(D),B=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),E=function(r){B(n,r);function n(t){var e=r.call(this)||this;return e.options=t,e.fillColor=e.options.fillColor,e.strokeColor=e.options.strokeColor,e.rect=e.options.rect,e}return n.prototype.draw=function(t,e){t.save(),t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor));var o=e.width;t.beginPath(),t.moveTo(0,0),t.lineTo(o,0),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),t.restore()},n}(_),U=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),N=function(r){U(n,r);function n(t){var e=r.call(this,t)||this;return e.options=t,e.startArrow=e.options.startArrow||"none",e.endArrow=e.options.endArrow||"line-arrow",e}return n.prototype.draw=function(t,e){t.save(),t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor));var o=e.width,i=new DOMPoint(0,0),s=new DOMPoint(o,0);t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.closePath(),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),this.startArrow&&T(t,i,this.startArrow),this.endArrow&&T(t,s,this.endArrow),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),t.restore()},n}(E);function T(r,n,t){var e=n.x,o=n.y,i=10,s=10;t==="line-arrow"&&(r.beginPath(),r.moveTo(e,o),r.lineTo(e-i,o-s),r.moveTo(e-i,o+s),r.lineTo(e,o)),t==="triangle-arrow"&&(r.beginPath(),r.moveTo(e,o),r.lineTo(e-i,o-s),r.lineTo(e-i,o+s),r.lineTo(e,o),r.closePath())}var q=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Q=function(r){q(n,r);function n(t){var e=r.call(this)||this;return e.options=t,e.fillColor=e.options.fillColor,e.strokeColor=e.options.strokeColor,e.rect=e.options.rect,e.counterclockwise=e.options.counterclockwise||!1,e}return n.prototype.draw=function(t,e){t.save();var o=e.width,i=e.height,s=o/2,a=i/2,l=0,h=2*Math.PI,c=0,f=!1;t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor)),t.translate(s,a),t.beginPath(),t.ellipse(0,0,s,a,c,l,h,f),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),t.restore()},n}(_),G=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),y=function(r){G(n,r);function n(t){var e=r.call(this)||this;return e.options=t,e.fillColor=e.options.fillColor,e.strokeColor=e.options.strokeColor,e.rect=e.options.rect,e.cornerRadius=e.options.cornerRadius,e}return n.prototype.draw=function(t,e){if(t.save(),t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor)),this.cornerRadius)if(Array.isArray(this.cornerRadius)){var o=this.cornerRadius,i=o[0],s=o[1],a=o[2],l=o[3];w(t,e,{tl:i,tr:s,br:a,bl:l}),this.fillColor&&t.fill(),this.strokeColor&&t.stroke()}else{var h=this.cornerRadius;w(t,e,{tl:h,tr:h,br:h,bl:h}),this.fillColor&&t.fill(),this.strokeColor&&t.stroke()}else this.fillColor&&t.fillRect(0,0,e.width,e.height),this.strokeColor&&t.strokeRect(0,0,e.width,e.height);t.restore()},n}(_);function w(r,n,t){var e=t.tl,o=t.tr,i=t.br,s=t.bl;r.beginPath(),r.moveTo(e,0),r.lineTo(n.width-o,0),r.quadraticCurveTo(n.width,0,n.width,o),r.lineTo(n.width,n.height-i),r.quadraticCurveTo(n.width,n.height,n.width-i,n.height),r.lineTo(s,n.height),r.quadraticCurveTo(0,n.height,0,n.height-s),r.lineTo(0,e),r.quadraticCurveTo(0,0,e,0),r.closePath()}var x=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),H=function(r){x(n,r);function n(t){var e=r.call(this,t)||this;e.options=t,e.loaded=!1,e.error=!1,e.smoothingEnabled=e.options.smoothingEnabled,e.smoothingQuality=e.options.smoothingQuality;var o=new Image;return o.crossOrigin="anonymous",o.src=t.image,e.image=o,o.onload=function(){e.loaded=!0},o.onerror=function(){e.error=!0,e.loaded=!0},e}return n.prototype.draw=function(t,e){if(r.prototype.draw.call(this,t,e),this.error)k(t,"red",e);else if(this.loaded){if(t.save(),this.options.smoothingEnabled&&this.options.smoothingQuality&&(t.imageSmoothingEnabled=!0,t.imageSmoothingQuality=this.options.smoothingQuality),this.cornerRadius){if(Array.isArray(this.cornerRadius)){var o=this.cornerRadius,i=o[0],s=o[1],a=o[2],l=o[3];w(t,e,{tl:i,tr:s,br:a,bl:l})}else{var h=this.cornerRadius;w(t,e,{tl:h,tr:h,br:h,bl:h})}t.clip()}t.drawImage(this.image,0,0,e.width,e.height),t.restore()}else k(t,"--canvas-grid-color",e)},n}(y);function k(r,n,t){r.save(),r.fillStyle=u(r.canvas,n),r.strokeStyle=u(r.canvas,n),r.strokeRect(0,0,t.width,t.height),r.beginPath(),r.moveTo(0,0),r.lineTo(t.width,t.height),r.moveTo(t.width,0),r.lineTo(0,t.height),r.stroke(),r.restore()}var F=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),R=function(r){F(n,r);function n(t){var e=r.call(this)||this;return e.options=t,e.fillColor=e.options.fillColor,e.strokeColor=e.options.strokeColor,e.rect=e.options.rect,e.pointCount=e.options.pointCount||5,e}return n.prototype.draw=function(t,e){t.save(),t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor));var o=e.width,i=e.height,s=o/2,a=i/2;t.beginPath();for(var l=0;l<this.pointCount;l++){var h=Math.PI*2/this.pointCount,c=s+s*Math.cos(h*l),f=a+a*Math.sin(h*l);l===0?t.moveTo(c,f):t.lineTo(c,f)}t.closePath(),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),t.restore()},n}(_),V=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),J=function(r){V(n,r);function n(t){var e=r.call(this,t)||this;return e.options=t,e.fillColor=e.options.fillColor,e.strokeColor=e.options.strokeColor,e.rect=e.options.rect,e.pointCount=e.options.pointCount||5,e.innerRadius=e.options.innerRadius,e.outerRadius=e.options.outerRadius,e}return n.prototype.draw=function(t,e){t.save(),t.lineWidth=this.lineWidth,this.fillColor&&(t.fillStyle=u(t.canvas,this.fillColor)),this.strokeColor&&(t.strokeStyle=u(t.canvas,this.strokeColor));var o=e.width,i=e.height,s=o/2,a=i/2,l=this.innerRadius||s/2,h=this.outerRadius||o/2,c=Math.PI/2*3,f=s,v=a,d=Math.PI/this.pointCount;t.beginPath(),t.moveTo(s,a-h);for(var p=0;p<this.pointCount;p++)f=s+Math.cos(c)*h,v=a+Math.sin(c)*h,t.lineTo(f,v),c+=d,f=s+Math.cos(c)*l,v=a+Math.sin(c)*l,t.lineTo(f,v),c+=d;t.lineTo(s,a-h),t.closePath(),this.fillColor&&t.fill(),this.strokeColor&&t.stroke(),t.restore()},n}(R),Z=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();(function(r){Z(n,r);function n(t){var e=r.call(this,t)||this;return e.options=t,e.child=e.options.child,e}return n.prototype.draw=function(t,e){r.prototype.draw.call(this,t,e),this.child.draw(t,e,this.rect)},n})(y);var z=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),tt=function(r){z(n,r);function n(){return r!==null&&r.apply(this,arguments)||this}return n}(D),et=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ot=function(r){et(n,r);function n(t){var e=this,o;return e=r.call(this)||this,e.options=t,e.children=e.options.children,e.rect=e.options.rect,e.clip=(o=e.options.clip)!==null&&o!==void 0?o:!0,e}return n.prototype.draw=function(t,e){t.save(),this.clip&&(t.save(),t.beginPath(),t.rect(0,0,e.width,e.height),t.clip());for(var o=0,i=this.children;o<i.length;o++){var s=i[o];t.translate(s.rect.x,s.rect.y),s.draw(t,s.rect,this.rect),t.translate(-s.rect.x,-s.rect.y)}t.restore()},n.prototype.selectAt=function(t,e){var o=r.prototype.selectAt.call(this,t,e);if(o)return o;for(var i=0,s=Array.from(this.children).reverse();i<s.length;i++){var a=s[i],l=new DOMPoint(t.x-this.rect.x,t.y-this.rect.y),h=a.selectAt(l,e-1);if(h)return h}return null},n.prototype.drawDecoration=function(t,e,o){r.prototype.drawDecoration.call(this,t,e,o);for(var i=0,s=this.children;i<s.length;i++){var a=s[i];t.translate(a.rect.x,a.rect.y),a.drawDecoration(t,e,o),t.translate(-a.rect.x,-a.rect.y)}},n}(tt);function nt(r,n,t){var e=t.offset,o=t.scale,i=t.backgroundColor,s=t.gridColor;n.save();var a=20*o,l=Math.round(e.x)%a,h=Math.round(e.y)%a;n.fillStyle=u(r,i),n.fillRect(0,0,r.width,r.height),n.strokeStyle=u(r,s),n.lineWidth=.23*o;for(var c=l;c<r.width;c+=a)n.beginPath(),n.moveTo(c,0),n.lineTo(c,r.height),n.stroke();for(var f=h;f<r.height;f+=a)n.beginPath(),n.moveTo(0,f),n.lineTo(r.width,f),n.stroke();n.restore()}var rt=function(){function r(){this.listeners=[]}return r.prototype.addListener=function(n){this.listeners.push(n)},r.prototype.removeListener=function(n){this.listeners=this.listeners.filter(function(t){return t!==n})},r.prototype.notifyListeners=function(){for(var n=0,t=this.listeners;n<t.length;n++){var e=t[n];e(this)}},r}(),it=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),A={scale:1,offset:new DOMPoint(0,0)},st=function(r){it(n,r);function n(t,e){t===void 0&&(t=document.createElement("canvas")),e===void 0&&(e=A);var o=r.call(this)||this;o.canvas=t,o.options=e,o.gestureEvent=!1,o.mouse=new DOMPoint(0,0),o.mouseDown=!1,o.spacePressed=!1,o.controlPressed=!1,o.shiftPressed=!1,o.metaPressed=!1,o.middleClick=!1,o.shouldNotify=!0,o.minScale=.1,o.maxScale=10,o.ctx=o.canvas.getContext("2d"),o.transform=o.ctx.getTransform(),o.shouldNotify=!1;var i=e.scale,s=e.offset;return o.scale(i),o.pan(s),o.shouldNotify=!0,o.onWheelEvent=o.onWheelEvent.bind(o),t.addEventListener("wheel",o.onWheelEvent,{passive:!1}),o.onMouseDown=o.onMouseDown.bind(o),t.addEventListener("mousedown",o.onMouseDown,!1),o.onMouseMove=o.onMouseMove.bind(o),t.addEventListener("mousemove",o.onMouseMove,!1),o.onMouseUp=o.onMouseUp.bind(o),t.addEventListener("mouseup",o.onMouseUp,!1),o.onTouchStart=o.onTouchStart.bind(o),t.addEventListener("touchstart",o.onTouchStart,!1),o.onTouchMove=o.onTouchMove.bind(o),t.addEventListener("touchmove",o.onTouchMove,!1),o.onTouchEnd=o.onTouchEnd.bind(o),t.addEventListener("touchend",o.onTouchEnd,!1),o.onDoubleClick=o.onDoubleClick.bind(o),t.addEventListener("dblclick",o.onDoubleClick,!1),o.onClick=o.onClick.bind(o),t.addEventListener("click",o.onClick,!1),o.onKeyDownEvent=o.onKeyDownEvent.bind(o),o.onKeyUpEvent=o.onKeyUpEvent.bind(o),document.addEventListener("keydown",o.onKeyDownEvent,!1),document.addEventListener("keyup",o.onKeyUpEvent,!1),o}return Object.defineProperty(n.prototype,"matrix",{get:function(){return this.transform},set:function(t){this.transform=t,this.notify()},enumerable:!1,configurable:!0}),n.prototype.notify=function(){!this.shouldNotify||this.notifyListeners()},n.prototype.localPoint=function(t){var e=this.info,o=e.scale,i=e.offset,s=t.x/o-i.x/o,a=t.y/o-i.y/o;return new DOMPoint(s,a)},n.prototype.applyTransform=function(t){t.setTransform(this.matrix)},n.prototype.scale=function(t,e){if(e===void 0&&(e=new DOMPoint(0,0)),!Number.isNaN(t)){var o=t*this.info.scale;if(this.options.scale=o,!(o<this.minScale||o>this.maxScale)){var i=this.localPoint(e);this.matrix=this.matrix.scale(t,t,0,i.x,i.y,i.z),this.notify()}}},n.prototype.pan=function(t){if(!Number.isNaN(t)){var e=this.info.scale;this.options.offset.x+=t.x/e,this.options.offset.y+=t.y/e,this.matrix=this.matrix.translate(t.x/e,t.y/e,t.z/e),this.notify()}},Object.defineProperty(n.prototype,"info",{get:function(){var t=at(this.matrix),e=t.scaleX,o=t.scaleY,i=t.translateX,s=t.translateY,a=t.rotate;return{scale:Math.min(e,o),offset:new DOMPoint(i,s),rotation:a,mouse:this.mouse,mouseDown:this.mouseDown}},enumerable:!1,configurable:!0}),n.prototype.onWheelEvent=function(t){if(this.preventDefault(t),!this.gestureEvent){var e=new DOMPoint(t.offsetX,t.offsetY);if(t.ctrlKey||this.controlPressed){var o=1;t.deltaY<0?o=Math.min(this.maxScale,o*1.1):o=Math.max(this.minScale,o*(1/1.1)),this.scale(o,e)}else this.pan(new DOMPoint(-t.deltaX,-t.deltaY))}},n.prototype.onMouseDown=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY),this.mouseDown=!0},n.prototype.onMouseMove=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY)},n.prototype.onMouseUp=function(t){this.mouse=new DOMPoint(t.offsetX,t.offsetY),this.mouseDown=!1},n.prototype.onTouchStart=function(t){this.preventDefault(t),this.touches=t.touches,this.mouseDown=!0,this.gestureEvent=this.touches.length>1},n.prototype.onTouchMove=function(t){this.preventDefault(t);var e=this.touches;if(this.touches=t.touches,this.gestureEvent){var o=new DOMPoint(e[0].clientX,e[0].clientY),i=new DOMPoint(e[1].clientX,e[1].clientY),s=new DOMPoint(this.touches[0].clientX,this.touches[0].clientY),a=new DOMPoint(this.touches[1].clientX,this.touches[1].clientY);if(this.touches.length===2){var l=new DOMPoint((o.x+i.x)/2,(o.y+i.y)/2),h=new DOMPoint((s.x+a.x)/2,(s.y+a.y)/2),c=P(o,i),f=P(s,a),v=f/c;if(this.scale(v,h),h!==l){var d=new DOMPoint(Math.min(o.x,i.x),Math.min(o.y,i.y)),p=new DOMPoint(Math.min(s.x,a.x),Math.min(s.y,a.y)),C=new DOMPoint(p.x-d.x,p.y-d.y);this.pan(C)}}else if(this.touches.length===3){var O=new DOMPoint(e[2].clientX,e[2].clientY),j=new DOMPoint(this.touches[2].clientX,this.touches[2].clientY),d=new DOMPoint(Math.min(o.x,i.x,O.x),Math.min(o.y,i.y,O.y)),p=new DOMPoint(Math.min(s.x,a.x,O.x),Math.min(s.y,a.y,j.y)),C=new DOMPoint(p.x-d.x,p.y-d.y);this.pan(C)}}},n.prototype.onTouchEnd=function(t){this.preventDefault(t),this.touches=t.touches,this.mouseDown=this.touches.length===0,this.gestureEvent=this.touches.length>1},n.prototype.onKeyDownEvent=function(t){this.preventDefault(t),t.key==="ArrowLeft"?this.pan(new DOMPoint(-10,0)):t.key==="ArrowRight"?this.pan(new DOMPoint(10,0)):t.key==="ArrowUp"?this.pan(new DOMPoint(0,-10)):t.key==="ArrowDown"?this.pan(new DOMPoint(0,10)):t.key==="="?this.scale(1.1,this.mouse):t.key==="-"&&this.scale(1/1.1,this.mouse),this.controlPressed=t.ctrlKey,this.shiftPressed=t.shiftKey,this.metaPressed=t.metaKey,this.spacePressed=t.key===" "},n.prototype.onKeyUpEvent=function(t){this.preventDefault(t),this.controlPressed=!1,this.spacePressed=!1,this.shiftPressed=!1,this.metaPressed=!1},n.prototype.onDoubleClick=function(t){this.preventDefault(t)},n.prototype.onClick=function(t){this.preventDefault(t)},n.prototype.preventDefault=function(t){t.preventDefault()},n}(rt);function at(r){var n=(r.a+r.d)/2,t=(r.a-r.d)/2,e=(r.c+r.b)/2,o=(r.c-r.b)/2,i=Math.sqrt(n*n+o*o),s=Math.sqrt(t*t+e*e),a=Math.atan2(e,t),l=Math.atan2(o,n),h=(l-a)/2,c=(l+a)/2;return{translateX:r.e,translateY:r.f,rotate:-c*180/Math.PI,scaleX:i+s,scaleY:i-s,skew:-h*180/Math.PI}}function P(r,n){return Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2))}var lt=globalThis&&globalThis.__extends||function(){var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},r(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),g=globalThis&&globalThis.__assign||function(){return g=Object.assign||function(r){for(var n,t=1,e=arguments.length;t<e;t++){n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},g.apply(this,arguments)},ht=g(g({},A),{devicePixelRatio:window.devicePixelRatio||1,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}),ct=function(r){lt(n,r);function n(t,e){t===void 0&&(t=document.createElement("canvas")),e===void 0&&(e=ht);var o=r.call(this,t,e)||this;return o.canvas=t,o.options=e,o.children=[],o.selection=[],o.hovered=[],o.canSelect=!0,o.canMove=!0,o.canDelete=!0,o.drawGrid=!0,o.selectIndex=0,o.isMoving=!1,o}return n.prototype.drawBackground=function(){var t=this.info,e=t.offset,o=t.scale,i=this,s=i.ctx,a=i.canvas;if(this.options.drawBackground!==void 0){s.save(),this.options.drawBackground(s,e,o),s.restore();return}s.save(),s.fillStyle=u(a,"--canvas-background-color"),s.fillRect(0,0,a.width,a.height),this.drawGrid&&nt(a,s,{offset:e,scale:o,backgroundColor:"--canvas-background-color",gridColor:"--canvas-grid-color"}),s.restore()},n.prototype.resize=function(){var t=this.canvas,e=getComputedStyle(t),o=this,i=o.canvas;o.ctx;var s=parseInt(e.width,10),a=parseInt(e.height,10);i.width=s,i.height=a},n.prototype.canvasResize=function(){var t=this,e=t.canvas,o=t.ctx,i=e.getBoundingClientRect(),s=this.options.devicePixelRatio;e.width=i.width*s,e.height=i.height*s,o.clearRect(0,0,e.width,e.height),o.scale(s,s)},n.prototype.paint=function(){var t=this,e=this,o=e.canvas,i=e.ctx;if(this.resize(),i.imageSmoothingEnabled=this.options.imageSmoothingEnabled,i.imageSmoothingQuality=this.options.imageSmoothingQuality,i.clearRect(0,0,o.width,o.height),this.drawBackground(),this.applyTransform(i),this.drawContent(i),this.applyTransform(i),this.selection.length>1){var s=M(this.selection.map(function(a){return a.rect}));i.save(),i.translate(s.x,s.y),this.drawOutline(i,s,"--canvas-selected-color"),i.restore()}requestAnimationFrame(function(){return t.paint()})},n.prototype.drawContent=function(t){for(var e=0,o=this.children;e<o.length;e++){var i=o[e];this.drawChild(t,i)}},n.prototype.drawChild=function(t,e,o){var i=e.rect;t.save(),t.translate(i.x,i.y),e.draw(this.ctx,{width:i.width,height:i.height}),e.drawDecoration(t,this.selection,this.hovered),t.translate(-i.x,-i.y),t.restore()},n.prototype.drawOutline=function(t,e,o){var i=this.canvas;if(this.options.drawOutline!==void 0){t.save(),this.options.drawOutline(t,e,o),t.restore();return}t.save(),t.strokeStyle=u(i,o),t.strokeRect(0,0,e.width,e.height),t.restore()},n.prototype.getSelectionAt=function(t,e){for(var o=this.localPoint(t),i=[],s=this.selectIndex+1;i.length===0&&s>-1;){s--;for(var a=0,l=Array.from(this.children).reverse();a<l.length;a++){var h=l[a],c=h.selectAt(o,s);c&&i.push(c)}}return i.slice(0,e.max)},n.prototype.onMouseDown=function(t){if(r.prototype.onMouseDown.call(this,t),this.middleClick=t.button===1,this.canSelect){if(this.selection.length>0){var e=this.localPoint(this.mouse),o=M(this.selection.map(function(s){return s.rect}));if(e.x>=o.x&&e.x<=o.x+o.width&&e.y>=o.y&&e.y<=o.y+o.height)return}var i=this.getSelectionAt(this.mouse,{max:1,level:this.selectIndex});this.updateSelection(i)}this.updateCursor()},n.prototype.onMouseUp=function(t){if(r.prototype.onMouseUp.call(this,t),this.canSelect&&!this.isMoving){var e=new DOMPoint(t.clientX,t.clientY);this.doubleClickAt(e)}this.isMoving=!1,this.middleClick=!1,this.updateCursor()},n.prototype.doubleClickAt=function(t){var e=this;this.dblClickTimeout!==void 0?(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=void 0,this.selectIndex+=1,this.mouse=t,this.selectAt(t)):this.dblClickTimeout=window.setTimeout(function(){e.dblClickTimeout=void 0,e.selectIndex=0,e.mouse=t,e.selectAt(t)},200)},n.prototype.onMouseMove=function(t){var e=this.mouse;r.prototype.onMouseMove.call(this,t),this.hovered=this.getSelectionAt(this.mouse,{max:1,level:0}),this.mouseDown&&(this.isMoving=!0,this.move(new DOMPoint(this.mouse.x-e.x,this.mouse.y-e.y))),this.updateCursor()},n.prototype.onTouchStart=function(t){if(r.prototype.onTouchStart.call(this,t),!this.gestureEvent&&this.canSelect){var e=t.touches[0],o=new DOMPoint(e.clientX,e.clientY);this.doubleClickAt(o)}},n.prototype.onTouchMove=function(t){var e=(this.touches||[])[0];if(r.prototype.onTouchMove.call(this,t),!this.gestureEvent){var o=t.touches[0];this.info.scale;var i=new DOMPoint(o.clientX-e.clientX,o.clientY-e.clientY);this.move(i)}},n.prototype.move=function(t){if(this.spacePressed||this.middleClick)this.pan(new DOMPoint(t.x,t.y));else if(this.canMove&&this.selection.length>0){for(var e=this.info.scale,o=0,i=this.selection;o<i.length;o++){var s=i[o];s.rect.x+=t.x/e,s.rect.y+=t.y/e}this.notify()}},n.prototype.onKeyDownEvent=function(t){r.prototype.onKeyDownEvent.call(this,t),t.key==="Backspace"&&this.removeSelection(),t.metaKey&&t.key==="a"&&this.updateSelection(this.children),this.updateCursor()},n.prototype.onKeyUpEvent=function(t){r.prototype.onKeyUpEvent.call(this,t),this.updateCursor()},n.prototype.updateCursor=function(){var t=this,e=t.hovered,o=t.selection,i=t.spacePressed,s=t.canMove,a=o.length>0&&o.every(function(l){return e.includes(l)});i||this.middleClick?this.canvas.style.cursor="grab":o.length>0&&a&&s?this.canvas.style.cursor="move":this.canvas.style.cursor="default"},n.prototype.selectAt=function(t){var e=this.getSelectionAt(t,{max:1,level:this.selectIndex});this.updateSelection(e)},n.prototype.updateSelection=function(t){var e=this;this.shiftPressed?(this.selection=this.selection.concat(t),this.selection=this.selection.filter(function(o,i){return e.selection.indexOf(o)===i})):this.selection=t,this.updateCursor(),this.notify()},n.prototype.clearSelection=function(){this.updateSelection([])},n.prototype.removeSelection=function(){var t=this;!this.canDelete||(this.children=this.children.filter(function(e){return!t.selection.includes(e)}),this.clearSelection())},n.prototype.addChild=function(t){this.children.push(t),this.updateSelection([t])},n}(st);function ut(r){const n=["circle","rect","star","polygon","line","arrow"];for(let o=0;o<20;o++){const i=n[Math.floor(Math.random()*n.length)],{x:s,y:a}={x:Math.random()*r.canvas.width,y:Math.random()*r.canvas.height},l=`hsl(${Math.random()*360}, 100%, 50%)`;i==="rect"&&r.addChild(new y({rect:new DOMRect(s,a,100,100),fillColor:l,cornerRadius:5})),i==="circle"&&r.addChild(new Q({rect:new DOMRect(s,a,100,100),fillColor:l})),i==="star"&&r.addChild(new J({rect:new DOMRect(s,a,100,100),fillColor:l})),i==="polygon"&&r.addChild(new R({rect:new DOMRect(s,a,100,100),fillColor:l,pointCount:9})),i==="line"&&r.addChild(new E({rect:new DOMRect(s,a,100,1),strokeColor:l})),i==="arrow"&&r.addChild(new N({rect:new DOMRect(s,a,100,1),strokeColor:l,fillColor:l,endArrow:"triangle-arrow"}))}for(let o=0;o<5;o++){const{x:i,y:s}={x:Math.random()*r.canvas.width,y:Math.random()*r.canvas.height};r.addChild(new H({rect:new DOMRect(i,s,100,100),image:`https://picsum.photos/seed/seed-${o+1}/300/300`}))}const{x:t,y:e}={x:Math.random()*r.canvas.width,y:Math.random()*r.canvas.height};r.addChild(new ot({clip:!1,rect:new DOMRect(t,e,100,100),children:[new y({rect:new DOMRect(0,0,100,100),fillColor:"purple",cornerRadius:5}),new y({rect:new DOMRect(5,5,100,100),fillColor:"blue",cornerRadius:5}),new y({rect:new DOMRect(10,10,100,100),fillColor:"yellow",cornerRadius:5})]}))}var ft=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,b=(r,n,t,e)=>{for(var o=e>1?void 0:e?dt(n,t):n,i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=(e?s(n,t,o):s(o))||o);return e&&o&&ft(n,t,o),o};let m=class extends X{render(){return W` <canvas id="canvas"></canvas> `}firstUpdated(){const r=this.canvas,n=new ct(r);n.addListener(()=>{const{offset:t,scale:e}=n.info;console.debug(`offset: ${t.x}, ${t.y}; scale: ${e}`)}),window.addEventListener("resize",()=>{r.width=window.innerWidth,r.height=window.innerHeight}),r.width=window.innerWidth,r.height=window.innerHeight,ut(n),n.clearSelection(),n.canvasResize(),window.addEventListener("canvasResize",()=>n.resize()),n.paint()}};m.styles=L`
    canvas {
      --canvas-background-color: #fafafa;
      --canvas-grid-color: #ccc;
      --canvas-selected-color: #f00;
      --canvas-hovered-color: #0f0;
      cursor: pointer;
      user-select: none;
      user-zoom: none;
    }
    @media (prefers-color-scheme: dark) {
      canvas {
        --canvas-background-color: #333;
        --canvas-grid-color: #666;
        --canvas-selected-color: #bd0303;
        --canvas-hovered-color: #04a104;
      }
    }
  `;b([Y("#canvas")],m.prototype,"canvas",2);m=b([I("canvas-editor")],m);
